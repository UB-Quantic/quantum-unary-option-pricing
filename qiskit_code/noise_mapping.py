import itertools
import numpy as np
from qiskit.providers.aer.noise.errors import QuantumError, ReadoutError, pauli_error, depolarizing_error, thermal_relaxation_error
from qiskit.providers.aer.noise import NoiseModel
from qiskit import IBMQ


def unary_coupling(qubits):
    entangling1 = [[i, i + 1] for i in range(qubits - 1)]
    entangling2 = [[i + 1, i] for i in range(qubits - 1)]
    entangling3 = [[i, qubits] for i in range(qubits)]

    coupling_map_unary = entangling1 + entangling2 + entangling3
    return coupling_map_unary


def binary_coupling(qubits):
    entangling1 = list(itertools.combinations(list(range(3,-1, -1)), r=2))
    entangling1 = [list(e) for e in entangling1]
    print(type(entangling1[0][0]))
    entangling2 = []
    for i in range(qubits - 1):
        entangling2 += [[i + 1, qubits + i], [i + 1, qubits + i + 1], [qubits + i, qubits + i + 1]]
    entangling3 = []
    for i in range(qubits):
        entangling3 += [[i, 2*qubits], [i, 2*qubits + 1]]
    entangling4 = [[0, qubits], [2*qubits - 1, 2*qubits], [2*qubits, 2*qubits + 1]]

    coupling_map_binary = entangling1 + entangling2 + entangling3 + entangling4
    return coupling_map_binary

def melbourne_coupling():
    provider = IBMQ.get_provider(group='open')
    device = provider.get_backend('ibmq_16_melbourne')
    #properties = device.properties()
    coupling_map = device.configuration().coupling_map
    return coupling_map

def thermal_map(noise_thermal, qubits, unary=True):
    # Thermal error
    # T1 and T2 values for qubits 0-16
    T1s = np.random.normal(50e3, 10e3, qubits)  # Sampled from normal distribution mean 50 microsec
    T2s = np.random.normal(70e3, 10e3, qubits)  # Sampled from normal distribution mean 50 microsec

    # Truncate random T2s <= T1s
    T2s = np.array([min(T2s[j], 2 * T1s[j]) for j in range(qubits)])

    # Instruction times (in nanoseconds)
    time_u1 = 0  # virtual gate
    time_u2 = 50  # (single X90 pulse)
    time_u3 = 100  # (two X90 pulses)
    time_cx = 300
    time_reset = 1000  # 1 microsecond
    time_measure = 1000  # 1 microsecond

    # QuantumError objects
    errors_reset = [thermal_relaxation_error(t1, t2, time_reset)
                    for t1, t2 in zip(T1s, T2s)]
    errors_measure = [thermal_relaxation_error(t1, t2, time_measure)
                      for t1, t2 in zip(T1s, T2s)]
    errors_u1 = [thermal_relaxation_error(t1, t2, time_u1)
                 for t1, t2 in zip(T1s, T2s)]
    errors_u2 = [thermal_relaxation_error(t1, t2, time_u2)
                 for t1, t2 in zip(T1s, T2s)]
    errors_u3 = [thermal_relaxation_error(t1, t2, time_u3)
                 for t1, t2 in zip(T1s, T2s)]

    for j in range(qubits):
        noise_thermal.add_quantum_error(errors_reset[j], "reset", [j])
        noise_thermal.add_quantum_error(errors_measure[j], "measure", [j])
        noise_thermal.add_quantum_error(errors_u1[j], "u1", [j])
        noise_thermal.add_quantum_error(errors_u2[j], "u2", [j])
        noise_thermal.add_quantum_error(errors_u3[j], "u3", [j])

    time_cx = 300
    if unary:
        coupling = unary_coupling(qubits)
    else:
        coupling = binary_coupling(qubits)
    TA = np.random.multivariate_normal([50e3, 70e3], [[10e3, 0],[0, 10e3]], len(coupling))  # Sampled from normal distribution mean 50 microsec
    TB = np.random.multivariate_normal([50e3, 70e3], [[10e3, 0],[0, 10e3]], len(coupling))

    errors_cx = [thermal_relaxation_error(ta[0], ta[1], time_cx).expand(
        thermal_relaxation_error(tb[0], tb[1], time_cx)) for ta, tb in zip(TA, TB)]
    for k in range(len(coupling)):
        noise_thermal.add_quantum_error(errors_cx[k], "cx", coupling[k])

    return noise_thermal


##############################
### DICTIONARIES #############
##############################

def noise_dict_melbourne(t):
    noise_dict = {'errors': [
        {'type': 'qerror',
       'operations': ['u2'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0010717385734719254 * t,
        0.0010717385734719254 * t,
        0.0010717385734719254 * t,
        1 - 3 * 0.0010717385734719254 * t],
       'gate_qubits': [[0]]},
      {'type': 'qerror',
       'operations': ['u2'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.003390987358297126 * t,
        0.003390987358297126 * t,
        0.003390987358297126 * t,
        1 - 3 * 0.003390987358297126 * t],
       'gate_qubits': [[1]]},
      {'type': 'qerror',
       'operations': ['u2'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0018821386436665144 * t,
        0.0018821386436665144 * t,
        0.0018821386436665144 * t,
        1 - 3 * 0.0018821386436665144 * t],
       'gate_qubits': [[2]]},
      {'type': 'qerror',
       'operations': ['u2'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.00042722535270783846 * t,
        0.00042722535270783846 * t,
        0.00042722535270783846 * t,
        1 - 3 * 0.00042722535270783846 * t],
       'gate_qubits': [[3]]},
      {'type': 'qerror',
       'operations': ['u2'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0017328701415447456 * t,
        0.0017328701415447456 * t,
        0.0017328701415447456 * t,
        1 - 3 * 0.0017328701415447456 * t],
       'gate_qubits': [[4]]},
      {'type': 'qerror',
       'operations': ['u2'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0013078155643365952 * t,
        0.0013078155643365952 * t,
        0.0013078155643365952 * t,
        1 - 3 * 0.0013078155643365952 * t],
       'gate_qubits': [[5]]},
      {'type': 'qerror',
       'operations': ['u2'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0006333647403968801 * t,
        0.0006333647403968801 * t,
        0.0006333647403968801 * t,
        1 - 3 * 0.0006333647403968801 * t],
       'gate_qubits': [[6]]},
      {'type': 'qerror',
       'operations': ['u2'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0009455656397100998 * t,
        0.0009455656397100998 * t,
        0.0009455656397100998 * t,
        1 - 3 * 0.0009455656397100998 * t],
       'gate_qubits': [[7]]},
      {'type': 'qerror',
       'operations': ['u2'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.00102005955886314 * t,
        0.00102005955886314 * t,
        0.00102005955886314 * t,
        1 - 3 * 0.00102005955886314 * t],
       'gate_qubits': [[8]]},
      {'type': 'qerror',
       'operations': ['u2'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0011871731412612108 * t,
        0.0011871731412612108 * t,
        0.0011871731412612108 * t,
        1 - 3 * 0.0011871731412612108 * t],
       'gate_qubits': [[9]]},
      {'type': 'qerror',
       'operations': ['u2'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0009923324488229357 * t,
        0.0009923324488229357 * t,
        0.0009923324488229357 * t,
        1 - 3 * 0.0009923324488229357 * t],
       'gate_qubits': [[10]]},
      {'type': 'qerror',
       'operations': ['u2'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.000977369393663996 * t,
        0.000977369393663996 * t,
        0.000977369393663996 * t,
        1 - 3 * 0.000977369393663996 * t],
       'gate_qubits': [[11]]},
      {'type': 'qerror',
       'operations': ['u2'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0019777552450077063 * t,
        0.0019777552450077063 * t,
        0.0019777552450077063 * t,
        1 - 3 * 0.0019777552450077063 * t],
       'gate_qubits': [[12]]},
      {'type': 'qerror',
       'operations': ['u2'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0024233168294962304 * t,
        0.0024233168294962304 * t,
        0.0024233168294962304 * t,
        1 - 3 * 0.0024233168294962304 * t],
       'gate_qubits': [[13]]},
      {'type': 'qerror',
       'operations': ['u3'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0021434771469438507 * t,
        0.0021434771469438507 * t,
        0.0021434771469438507 * t,
        1 - 3 * 0.0021434771469438507 * t],
       'gate_qubits': [[0]]},
      {'type': 'qerror',
       'operations': ['u3'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.006781974716594252 * t,
        0.006781974716594252 * t,
        0.006781974716594252 * t,
        1 - 3 * 0.006781974716594252 * t],
       'gate_qubits': [[1]]},
      {'type': 'qerror',
       'operations': ['u3'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.003764277287333029 * t,
        0.003764277287333029 * t,
        0.003764277287333029 * t,
        1 - 3 * 0.003764277287333029 * t],
       'gate_qubits': [[2]]},
      {'type': 'qerror',
       'operations': ['u3'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0008544507054156769 * t,
        0.0008544507054156769 * t,
        0.0008544507054156769 * t,
        1 - 3 * 0.0008544507054156769 * t],
       'gate_qubits': [[3]]},
      {'type': 'qerror',
       'operations': ['u3'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0034657402830894912 * t,
        0.0034657402830894912 * t,
        0.0034657402830894912 * t,
        1 - 3 * 0.0034657402830894912 * t],
       'gate_qubits': [[4]]},
      {'type': 'qerror',
       'operations': ['u3'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0026156311286731904 * t,
        0.0026156311286731904 * t,
        0.0026156311286731904 * t,
        1 - 3 * 0.0026156311286731904 * t],
       'gate_qubits': [[5]]},
      {'type': 'qerror',
       'operations': ['u3'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0012667294807937601 * t,
        0.0012667294807937601 * t,
        0.0012667294807937601 * t,
        1 - 3 * 0.0012667294807937601 * t],
       'gate_qubits': [[6]]},
      {'type': 'qerror',
       'operations': ['u3'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0018911312794201995 * t,
        0.0018911312794201995 * t,
        0.0018911312794201995 * t,
        1 - 3 * 0.0018911312794201995 * t],
       'gate_qubits': [[7]]},
      {'type': 'qerror',
       'operations': ['u3'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.00204011911772628 * t,
        0.00204011911772628 * t,
        0.00204011911772628 * t,
        1 - 3 * 0.00204011911772628 * t],
       'gate_qubits': [[8]]},
      {'type': 'qerror',
       'operations': ['u3'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0023743462825224215 * t,
        0.0023743462825224215 * t,
        0.0023743462825224215 * t,
        1 - 3 * 0.0023743462825224215 * t],
       'gate_qubits': [[9]]},
      {'type': 'qerror',
       'operations': ['u3'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0019846648976458714 * t,
        0.0019846648976458714 * t,
        0.0019846648976458714 * t,
        1 - 3 * 0.0019846648976458714 * t],
       'gate_qubits': [[10]]},
      {'type': 'qerror',
       'operations': ['u3'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.001954738787327992 * t,
        0.001954738787327992 * t,
        0.001954738787327992 * t,
        1 - 3 * 0.001954738787327992 * t],
       'gate_qubits': [[11]]},
      {'type': 'qerror',
       'operations': ['u3'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0039555104900154126 * t,
        0.0039555104900154126 * t,
        0.0039555104900154126 * t,
        1 - 3 * 0.0039555104900154126 * t],
       'gate_qubits': [[12]]},
      {'type': 'qerror',
       'operations': ['u3'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.004846633658992461 * t,
        0.004846633658992461 * t,
        0.004846633658992461 * t,
        1 - 3 * 0.004846633658992461 * t],
       'gate_qubits': [[13]]},
      {'type': 'qerror',
       'operations': ['cx'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'x', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0031433611634990055 * t,
        0.0031433611634990055 * t,
        0.0031433611634990055 * t,
        0.0031433611634990055 * t,
        0.0031433611634990055 * t,
        0.0031433611634990055 * t,
        0.0031433611634990055 * t,
        0.0031433611634990055 * t,
        0.0031433611634990055 * t,
        0.0031433611634990055 * t,
        0.0031433611634990055 * t,
        0.0031433611634990055 * t,
        0.0031433611634990055 * t,
        0.0031433611634990055 * t,
        0.0031433611634990055 * t,
        1 - 15 * 0.0031433611634990055 * t],
       'gate_qubits': [[1, 0]]},
      {'type': 'qerror',
       'operations': ['cx'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'x', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.00376747383597389 * t,
        0.00376747383597389 * t,
        0.00376747383597389 * t,
        0.00376747383597389 * t,
        0.00376747383597389 * t,
        0.00376747383597389 * t,
        0.00376747383597389 * t,
        0.00376747383597389 * t,
        0.00376747383597389 * t,
        0.00376747383597389 * t,
        0.00376747383597389 * t,
        0.00376747383597389 * t,
        0.00376747383597389 * t,
        0.00376747383597389 * t,
        0.00376747383597389 * t,
        1 - 15 * 0.00376747383597389 * t],
       'gate_qubits': [[1, 2]]},
      {'type': 'qerror',
       'operations': ['cx'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'x', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.003424057800868433 * t,
        0.003424057800868433 * t,
        0.003424057800868433 * t,
        0.003424057800868433 * t,
        0.003424057800868433 * t,
        0.003424057800868433 * t,
        0.003424057800868433 * t,
        0.003424057800868433 * t,
        0.003424057800868433 * t,
        0.003424057800868433 * t,
        0.003424057800868433 * t,
        0.003424057800868433 * t,
        0.003424057800868433 * t,
        0.003424057800868433 * t,
        0.003424057800868433 * t,
        1 - 15 * 0.003424057800868433 * t],
       'gate_qubits': [[2, 3]]},
      {'type': 'qerror',
       'operations': ['cx'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'x', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.00564890312026483 * t,
        0.00564890312026483 * t,
        0.00564890312026483 * t,
        0.00564890312026483 * t,
        0.00564890312026483 * t,
        0.00564890312026483 * t,
        0.00564890312026483 * t,
        0.00564890312026483 * t,
        0.00564890312026483 * t,
        0.00564890312026483 * t,
        0.00564890312026483 * t,
        0.00564890312026483 * t,
        0.00564890312026483 * t,
        0.00564890312026483 * t,
        0.00564890312026483 * t,
        1 - 15 * 0.00564890312026483 * t],
       'gate_qubits': [[4 * t, 3]]},
      {'type': 'qerror',
       'operations': ['cx'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'x', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.007492154997273566 * t,
        0.007492154997273566 * t,
        0.007492154997273566 * t,
        0.007492154997273566 * t,
        0.007492154997273566 * t,
        0.007492154997273566 * t,
        0.007492154997273566 * t,
        0.007492154997273566 * t,
        0.007492154997273566 * t,
        0.007492154997273566 * t,
        0.007492154997273566 * t,
        0.007492154997273566 * t,
        0.007492154997273566 * t,
        0.007492154997273566 * t,
        0.007492154997273566 * t,
        1 - 15 * 0.007492154997273566 * t],
       'gate_qubits': [[4, 10]]},
      {'type': 'qerror',
       'operations': ['cx'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'x', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.00812818460823623 * t,
        0.00812818460823623 * t,
        0.00812818460823623 * t,
        0.00812818460823623 * t,
        0.00812818460823623 * t,
        0.00812818460823623 * t,
        0.00812818460823623 * t,
        0.00812818460823623 * t,
        0.00812818460823623 * t,
        0.00812818460823623 * t,
        0.00812818460823623 * t,
        0.00812818460823623 * t,
        0.00812818460823623 * t,
        0.00812818460823623 * t,
        0.00812818460823623 * t,
        1 - 15 * 0.00812818460823623 * t],
       'gate_qubits': [[5, 4]]},
      {'type': 'qerror',
       'operations': ['cx'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'x', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0052149521270598645 * t,
        0.0052149521270598645 * t,
        0.0052149521270598645 * t,
        0.0052149521270598645 * t,
        0.0052149521270598645 * t,
        0.0052149521270598645 * t,
        0.0052149521270598645 * t,
        0.0052149521270598645 * t,
        0.0052149521270598645 * t,
        0.0052149521270598645 * t,
        0.0052149521270598645 * t,
        0.0052149521270598645 * t,
        0.0052149521270598645 * t,
        0.0052149521270598645 * t,
        0.0052149521270598645 * t,
        1 - 15 * 0.0052149521270598645 * t],
       'gate_qubits': [[5, 6]]},
      {'type': 'qerror',
       'operations': ['cx'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'x', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.00490449589379269 * t,
        0.00490449589379269 * t,
        0.00490449589379269 * t,
        0.00490449589379269 * t,
        0.00490449589379269 * t,
        0.00490449589379269 * t,
        0.00490449589379269 * t,
        0.00490449589379269 * t,
        0.00490449589379269 * t,
        0.00490449589379269 * t,
        0.00490449589379269 * t,
        0.00490449589379269 * t,
        0.00490449589379269 * t,
        0.00490449589379269 * t,
        0.00490449589379269 * t,
        1 - 15 * 0.00490449589379269 * t],
       'gate_qubits': [[5, 9]]},
      {'type': 'qerror',
       'operations': ['cx'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'x', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.003026084675262946 * t,
        0.003026084675262946 * t,
        0.003026084675262946 * t,
        0.003026084675262946 * t,
        0.003026084675262946 * t,
        0.003026084675262946 * t,
        0.003026084675262946 * t,
        0.003026084675262946 * t,
        0.003026084675262946 * t,
        0.003026084675262946 * t,
        0.003026084675262946 * t,
        0.003026084675262946 * t,
        0.003026084675262946 * t,
        0.003026084675262946 * t,
        0.003026084675262946 * t,
        1 - 15 * 0.003026084675262946 * t],
       'gate_qubits': [[6, 8]]},
      {'type': 'qerror',
       'operations': ['cx'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'x', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0023760157329973525 * t,
        0.0023760157329973525 * t,
        0.0023760157329973525 * t,
        0.0023760157329973525 * t,
        0.0023760157329973525 * t,
        0.0023760157329973525 * t,
        0.0023760157329973525 * t,
        0.0023760157329973525 * t,
        0.0023760157329973525 * t,
        0.0023760157329973525 * t,
        0.0023760157329973525 * t,
        0.0023760157329973525 * t,
        0.0023760157329973525 * t,
        0.0023760157329973525 * t,
        0.0023760157329973525 * t,
        1 - 15 * 0.0023760157329973525 * t],
       'gate_qubits': [[7, 8]]},
      {'type': 'qerror',
       'operations': ['cx'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'x', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.004192751366099058 * t,
        0.004192751366099058 * t,
        0.004192751366099058 * t,
        0.004192751366099058 * t,
        0.004192751366099058 * t,
        0.004192751366099058 * t,
        0.004192751366099058 * t,
        0.004192751366099058 * t,
        0.004192751366099058 * t,
        0.004192751366099058 * t,
        0.004192751366099058 * t,
        0.004192751366099058 * t,
        0.004192751366099058 * t,
        0.004192751366099058 * t,
        0.004192751366099058 * t,
        1 - 15 * 0.004192751366099058 * t],
       'gate_qubits': [[9, 8]]},
      {'type': 'qerror',
       'operations': ['cx'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'x', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0042776967400056124 * t,
        0.0042776967400056124 * t,
        0.0042776967400056124 * t,
        0.0042776967400056124 * t,
        0.0042776967400056124 * t,
        0.0042776967400056124 * t,
        0.0042776967400056124 * t,
        0.0042776967400056124 * t,
        0.0042776967400056124 * t,
        0.0042776967400056124 * t,
        0.0042776967400056124 * t,
        0.0042776967400056124 * t,
        0.0042776967400056124 * t,
        0.0042776967400056124 * t,
        0.0042776967400056124 * t,
        1 - 15 * 0.0042776967400056124 * t],
       'gate_qubits': [[9, 10]]},
      {'type': 'qerror',
       'operations': ['cx'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'x', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0020680883509642534 * t,
        0.0020680883509642534 * t,
        0.0020680883509642534 * t,
        0.0020680883509642534 * t,
        0.0020680883509642534 * t,
        0.0020680883509642534 * t,
        0.0020680883509642534 * t,
        0.0020680883509642534 * t,
        0.0020680883509642534 * t,
        0.0020680883509642534 * t,
        0.0020680883509642534 * t,
        0.0020680883509642534 * t,
        0.0020680883509642534 * t,
        0.0020680883509642534 * t,
        0.0020680883509642534 * t,
        1 - 15 * 0.0020680883509642534 * t],
       'gate_qubits': [[11, 3]]},
      {'type': 'qerror',
       'operations': ['cx'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'x', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0026873234686195097 * t,
        0.0026873234686195097 * t,
        0.0026873234686195097 * t,
        0.0026873234686195097 * t,
        0.0026873234686195097 * t,
        0.0026873234686195097 * t,
        0.0026873234686195097 * t,
        0.0026873234686195097 * t,
        0.0026873234686195097 * t,
        0.0026873234686195097 * t,
        0.0026873234686195097 * t,
        0.0026873234686195097 * t,
        0.0026873234686195097 * t,
        0.0026873234686195097 * t,
        0.0026873234686195097 * t,
        1 - 15 * 0.0026873234686195097 * t],
       'gate_qubits': [[11, 10]]},
      {'type': 'qerror',
       'operations': ['cx'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'x', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.0032753194370960317 * t,
        0.0032753194370960317 * t,
        0.0032753194370960317 * t,
        0.0032753194370960317 * t,
        0.0032753194370960317 * t,
        0.0032753194370960317 * t,
        0.0032753194370960317 * t,
        0.0032753194370960317 * t,
        0.0032753194370960317 * t,
        0.0032753194370960317 * t,
        0.0032753194370960317 * t,
        0.0032753194370960317 * t,
        0.0032753194370960317 * t,
        0.0032753194370960317 * t,
        0.0032753194370960317 * t,
        1 - 15 * 0.0032753194370960317 * t],
       'gate_qubits': [[11, 12]]},
      {'type': 'qerror',
       'operations': ['cx'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'x', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.007661305444823144 * t,
        0.007661305444823144 * t,
        0.007661305444823144 * t,
        0.007661305444823144 * t,
        0.007661305444823144 * t,
        0.007661305444823144 * t,
        0.007661305444823144 * t,
        0.007661305444823144 * t,
        0.007661305444823144 * t,
        0.007661305444823144 * t,
        0.007661305444823144 * t,
        0.007661305444823144 * t,
        0.007661305444823144 * t,
        0.007661305444823144 * t,
        0.007661305444823144 * t,
        1 - 15 * 0.007661305444823144 * t],
       'gate_qubits': [[12, 2]]},
      {'type': 'qerror',
       'operations': ['cx'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'x', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.006821556392678968 * t,
        0.006821556392678968 * t,
        0.006821556392678968 * t,
        0.006821556392678968 * t,
        0.006821556392678968 * t,
        0.006821556392678968 * t,
        0.006821556392678968 * t,
        0.006821556392678968 * t,
        0.006821556392678968 * t,
        0.006821556392678968 * t,
        0.006821556392678968 * t,
        0.006821556392678968 * t,
        0.006821556392678968 * t,
        0.006821556392678968 * t,
        0.006821556392678968 * t,
        1 - 15 * 0.006821556392678968 * t],
       'gate_qubits': [[13, 1]]},
      {'type': 'qerror',
       'operations': ['cx'],
       'instructions': [[{'name': 'x', 'qubits': [0]}],
        [{'name': 'y', 'qubits': [0]}],
        [{'name': 'z', 'qubits': [0]}],
        [{'name': 'x', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [1]}],
        [{'name': 'x', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'y', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'z', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
        [{'name': 'id', 'qubits': [0]}]],
       'probabilities': [0.00956149741311246 * t,
        0.00956149741311246 * t,
        0.00956149741311246 * t,
        0.00956149741311246 * t,
        0.00956149741311246 * t,
        0.00956149741311246 * t,
        0.00956149741311246 * t,
        0.00956149741311246 * t,
        0.00956149741311246 * t,
        0.00956149741311246 * t,
        0.00956149741311246 * t,
        0.00956149741311246 * t,
        0.00956149741311246 * t,
        0.00956149741311246 * t,
        0.00956149741311246 * t,
        1 - 15 * 0.00956149741311246 * t],
       'gate_qubits': [[13, 12]]},
      {'type': 'roerror',
       'operations': ['measure'],
       'probabilities': [[1 - 0.025399999999999978 * t, 0.025399999999999978 * t],
        [0.025399999999999978 * t, 1 - 0.025399999999999978 * t]],
       'gate_qubits': [[0]]},
      {'type': 'roerror',
       'operations': ['measure'],
       'probabilities': [[1 - 0.1060000000000001 * t, 0.1060000000000001 * t],
        [0.1060000000000001 * t, 1 - 0.1060000000000001 * t]],
       'gate_qubits': [[1]]},
      {'type': 'roerror',
       'operations': ['measure'],
       'probabilities': [[1 - 0.0696 * t, 0.0696 * t], [0.0696 * t, 1 - 0.0696 * t]],
       'gate_qubits': [[2]]},
      {'type': 'roerror',
       'operations': ['measure'],
       'probabilities': [[1 - 0.036699999999999955 * t, 0.036699999999999955 * t],
        [0.036699999999999955 * t, 1 - 0.036699999999999955 * t]],
       'gate_qubits': [[3]]},
      {'type': 'roerror',
       'operations': ['measure'],
       'probabilities': [[1 - 0.0696 * t, 0.0696 * t], [0.0696 * t, 1 - 0.0696 * t]],
       'gate_qubits': [[4]]},
      {'type': 'roerror',
       'operations': ['measure'],
       'probabilities': [[1 - 0.05469999999999997 * t, 0.05469999999999997 * t],
        [0.05469999999999997 * t, 1 - 0.05469999999999997 * t]],
       'gate_qubits': [[5]]},
      {'type': 'roerror',
       'operations': ['measure'],
       'probabilities': [[1 - 0.03299999999999992 * t, 0.03299999999999992 * t],
        [0.03299999999999992 * t, 1 - 0.03299999999999992 * t]],
       'gate_qubits': [[6]]},
      {'type': 'roerror',
       'operations': ['measure'],
       'probabilities': [[1 - 0.15739999999999998 * t, 0.15739999999999998 * t],
        [0.15739999999999998 * t, 1 - 0.15739999999999998 * t]],
       'gate_qubits': [[7]]},
      {'type': 'roerror',
       'operations': ['measure'],
       'probabilities': [[1 - 0.0877 * t, 0.0877 * t], [0.0877 * t, 1 - 0.0877 * t]],
       'gate_qubits': [[8]]},
      {'type': 'roerror',
       'operations': ['measure'],
       'probabilities': [[1 - 0.041100000000000025 * t, 0.041100000000000025 * t],
        [0.041100000000000025 * t, 1 - 0.041100000000000025 * t]],
       'gate_qubits': [[9]]},
      {'type': 'roerror',
       'operations': ['measure'],
       'probabilities': [[1 - 0.0746 * t, 0.0746 * t], [0.0746 * t, 1 - 0.0746 * t]],
       'gate_qubits': [[10]]},
      {'type': 'roerror',
       'operations': ['measure'],
       'probabilities': [[1 - 0.05610000000000004 * t, 0.05610000000000004 * t],
        [0.05610000000000004 * t, 1 - 0.05610000000000004 * t]],
       'gate_qubits': [[11]]},
      {'type': 'roerror',
       'operations': ['measure'],
       'probabilities': [[1 - 0.05879999999999996 * t, 0.05879999999999996 * t],
        [0.05879999999999996 * t, 1 - 0.05879999999999996 * t]],
       'gate_qubits': [[12]]},
      {'type': 'roerror',
       'operations': ['measure'],
       'probabilities': [[1 - 0.09870000000000001 * t, 0.09870000000000001 * t],
        [0.09870000000000001 * t, 1 - 0.09870000000000001 * t]],
       'gate_qubits': [[13]]}],
     'x90_gates': []}
    return noise_dict


def noise_model_melbourne(t):
    noise_model = NoiseModel()
    noise_dict = noise_dict_melbourne(t)
    noise_model.from_dict(noise_dict)
    return noise_model

def u2_errors(err, q):
     d = {'type': 'qerror',
     'operations': ['u2'],
     'instructions': [[{'name': 'x', 'qubits': [0]}],
                      [{'name': 'y', 'qubits': [0]}],
                      [{'name': 'z', 'qubits': [0]}],
                      [{'name': 'id', 'qubits': [0]}]],
     'probabilities': [err,
                       err,
                       err,
                       1 - 3 * err],
     'gate_qubits': [[q]]}

     return d


def u3_errors(err, q):
      d = {'type': 'qerror',
      'operations': ['u3'],
      'instructions': [[{'name': 'x', 'qubits': [0]}],
                       [{'name': 'y', 'qubits': [0]}],
                       [{'name': 'z', 'qubits': [0]}],
                       [{'name': 'id', 'qubits': [0]}]],
      'probabilities': [err,
                        err,
                        err,
                        1 - 3 * err],
      'gate_qubits': [[q]]}

      return d


def cx_errors(err, q_s):
      d = {'type': 'qerror',
        'operations': ['cx'],
        'instructions': [[{'name': 'x', 'qubits': [0]}],
                   [{'name': 'y', 'qubits': [0]}],
                   [{'name': 'z', 'qubits': [0]}],
                   [{'name': 'x', 'qubits': [1]}],
                   [{'name': 'x', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
                   [{'name': 'y', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
                   [{'name': 'z', 'qubits': [0]}, {'name': 'x', 'qubits': [1]}],
                   [{'name': 'y', 'qubits': [1]}],
                   [{'name': 'x', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
                   [{'name': 'y', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
                   [{'name': 'z', 'qubits': [0]}, {'name': 'y', 'qubits': [1]}],
                   [{'name': 'z', 'qubits': [1]}],
                   [{'name': 'x', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
                   [{'name': 'y', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
                   [{'name': 'z', 'qubits': [0]}, {'name': 'z', 'qubits': [1]}],
                   [{'name': 'id', 'qubits': [0]}]],
        'probabilities': [err,
                          err,
                          err,
                          err,
                          err,
                          err,
                          err,
                          err,
                          err,
                          err,
                          err,
                          err,
                          err,
                          err,
                          err,
                          1 - 15 * err],
        'gate_qubits': [q_s]}

      return d




def measure_errors(err, q):
      d = {'type': 'roerror',
       'operations': ['measure'],
       'probabilities': [[1 - err, err],
                    [err, 1 - err]],
       'gate_qubits': [[q]]}

      return d

def noise_dict_unary(qubits, t):
    u2error=0.001
    u3error = 0.005
    cxerror = 0.01
    measureerror=0.05

    u2 = [u2_errors(u2error * t, q) for q in range(qubits)]
    u3 = [u3_errors(u3error * t, q) for q in range(qubits)]
    coupling_map = unary_coupling(qubits)
    cx = [cx_errors(cxerror * t, q_s) for q_s in coupling_map]
    measure = [measure_errors(measureerror * t, q) for q in range(qubits)]
    noise_dict = {'qerror': u2 + u3 + cx + measure,
                  'x90_gates': []}
    return noise_dict

def noise_model_unary(qubits, t):
    noise_model = NoiseModel()#basis_gates=['id', 'u2', 'u3', 'cx'])
    flip_error = 0.001 * t
    phase_error = 0.002 * t
    cnot_error = 0.01 * t
    p1given0 = 0.1 * t
    p0given1=0.05 * t
    identity = pauli_error([('I', 1)])
    bit_flip = pauli_error([('X', flip_error), ('I', 1 - flip_error)])
    phase_flip = pauli_error([('Z', phase_error), ('I', 1 - phase_error)])
    bitphase_flip = bit_flip.compose(phase_flip)
    cnot_flip = pauli_error([('X', cnot_error), ('I', 1 - cnot_error)])
    cnot_phase = pauli_error([('Z', cnot_error), ('I', 1 - cnot_error)])
    cnot_error = cnot_flip.compose(cnot_phase)
    cnot_error = identity.tensor(cnot_error)
    coupling_map = unary_coupling(qubits)
    for c in coupling_map:
        noise_model.add_quantum_error(cnot_error, ['cx'], c, warnings=False)

    noise_model.add_all_qubit_quantum_error(bitphase_flip, ["u1", "u2", "u3"])

    measure_error = ReadoutError([[1 - p1given0, p1given0], [p0given1, 1 - p0given1]])
    noise_model.add_all_qubit_readout_error(measure_error, ["u1", "u2", "u3"])

    """noise_dict = noise_dict_unary(qubits, t)
    noise_model.from_dict(noise_dict)"""
    return noise_model


def noise_model_binary(qubits, t):
    noise_model = NoiseModel()  # basis_gates=['id', 'u2', 'u3', 'cx'])
    flip_error = 0.001 * t
    phase_error = 0.002 * t
    cnot_error = 0.01 * t
    p1given0 = 0.1 * t
    p0given1 = 0.05 * t
    identity = pauli_error([('I', 1)])
    bit_flip = pauli_error([('X', flip_error), ('I', 1 - flip_error)])
    phase_flip = pauli_error([('Z', phase_error), ('I', 1 - phase_error)])
    bitphase_flip = bit_flip.compose(phase_flip)
    cnot_flip = pauli_error([('X', cnot_error), ('I', 1 - cnot_error)])
    cnot_phase = pauli_error([('Z', cnot_error), ('I', 1 - cnot_error)])
    cnot_error = cnot_flip.compose(cnot_phase)
    cnot_error = identity.tensor(cnot_error)
    coupling_map = binary_coupling(qubits)
    for c in coupling_map:
     noise_model.add_quantum_error(cnot_error, ['cx'], c, warnings=False)

    noise_model.add_all_qubit_quantum_error(bitphase_flip, ["u1", "u2", "u3"])

    measure_error = ReadoutError([[1 - p1given0, p1given0], [p0given1, 1 - p0given1]])
    noise_model.add_all_qubit_readout_error(measure_error, ["u1", "u2", "u3"])

    """noise_dict = noise_dict_unary(qubits, t)
    noise_model.from_dict(noise_dict)"""
    return noise_model


def noise_dict_unary(qubits, t):
    u2error = 0.001
    u3error = 0.005
    cxerror = 0.01
    measureerror = 0.05

    u2 = [u2_errors(u2error * t, q) for q in range(qubits)]
    u3 = [u3_errors(u3error * t, q) for q in range(qubits)]
    coupling_map = unary_coupling(qubits)
    cx = [cx_errors(cxerror * t, q_s) for q_s in coupling_map]
    measure = [measure_errors(measureerror * t, q) for q in range(qubits)]
    noise_dict = {'qerror': u2 + u3 + cx + measure,
                  'x90_gates': []}
    return noise_dict

